<div class="container">
  <header class="form-header">
    <a routerLink="/pacientes" class="btn btn-back">&larr; Voltar para a Lista</a>
    <h1>{{ isEditMode ? 'Editar Paciente' : 'Novo Pré-Cadastro de Paciente' }}</h1>
  </header>

  <form #pacienteForm="ngForm" (ngSubmit)="onSubmit()" class="paciente-form">
    <div class="form-row">
      <div class="form-group full-width">
        <label for="nome">Nome Completo</label>
        <input type="text" id="nome" name="nome" [(ngModel)]="paciente.nome" class="form-control" required>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group full-width">
        <label for="nomeMae">Nome da Mãe</label>
        <input type="text" id="nomeMae" name="nomeMae" [(ngModel)]="paciente.nomeMae" class="form-control">
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="cpf">CPF</label>
        <input type="text" id="cpf" name="cpf" [(ngModel)]="paciente.cpf" class="form-control" mask="000.000.000-00"
          required>
      </div>
      <div class="form-group">
        <label for="rg">RG</label>
        <input type="text" id="rg" name="rg" [(ngModel)]="paciente.rg" class="form-control">
      </div>
      <div class="form-group">
        <label for="cns">CNS</label>
        <input type="text" id="cns" name="cns" [(ngModel)]="paciente.cns" class="form-control">
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="dataNascimento">Data de Nascimento</label>
        <input type="date" id="dataNascimento" name="dataNascimento" [(ngModel)]="paciente.dataNascimento"
          class="form-control">
      </div>
      <div class="form-group">
        <label for="telefone">Telefone / Celular</label>
        <input type="text" id="telefone" name="telefone" [(ngModel)]="paciente.telefone" class="form-control"
          mask="(00) 0000-0000||(00) 0 0000-0000">
      </div>
      <div class="form-group">
        <label for="cor">Cor</label>
        <input type="text" id="cor" name="cor" [(ngModel)]="paciente.cor" class="form-control">
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="peso">Peso (kg)</label>
        <input type="number" id="peso" name="peso" [(ngModel)]="paciente.peso" class="form-control" min="1" max="500"
          #pesoInput="ngModel">
        <div *ngIf="pesoInput.invalid && (pesoInput.dirty || pesoInput.touched)" class="error-text">
          <div *ngIf="pesoInput.errors?.['min'] || pesoInput.errors?.['max']">
            Peso deve ser um valor realista (entre 1 e 500 kg).
          </div>
        </div>
      </div>

      <div class="form-group">
        <label for="altura">Altura (em metros, ex: 1.75)</label>
        <input type="number" id="altura" name="altura" step="0.01" [(ngModel)]="paciente.altura" class="form-control"
          min="0.5" max="2.5" #alturaInput="ngModel">
        <div *ngIf="alturaInput.invalid && (alturaInput.dirty || alturaInput.touched)" class="error-text">
          <div *ngIf="alturaInput.errors?.['min'] || alturaInput.errors?.['max']">
            Altura deve ser um valor em metros (ex: 1.75).
          </div>
        </div>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group full-width">
        <label for="endereco">Endereço</label>
        <input type="text" id="endereco" name="endereco" [(ngModel)]="paciente.endereco" class="form-control">
      </div>
    </div>

    <div class="form-actions">
      <button type="submit" class="btn btn-success" [disabled]="!pacienteForm.form.valid">
        {{ isEditMode ? 'Salvar Alterações' : 'Criar Cadastro' }}
      </button>
      <a routerLink="/pacientes" class="btn btn-secondary">Cancelar</a>
    </div>
  </form>
</div>